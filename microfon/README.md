# Система обнаружения дронов

Данная система предназначена для обнаружения и локализации дронов с помощью звуковых сигналов, нейронной сети и визуализации результатов на интерактивной карте.

## Структура проекта

- `RasbaryPi2.py` - основной файл с нейронной сетью для классификации звуков и определения сектора обнаружения дрона
- `mic_sender.py` - скрипт для захвата аудио с микрофонов и передачи данных на сервер
- `locator_static/` - веб-интерфейс (фронтенд) для визуализации результатов
- `mic_startup.bat` - скрипт для автоматического запуска всех компонентов системы с микрофонами
- `startup.bat` - скрипт для запуска только сервера и веб-интерфейса (без микрофонов)

## Требования

1. Python 3.7 или выше
2. Node.js и npm
3. Библиотеки Python:
   - pytorch
   - librosa
   - numpy
   - websockets
   - asyncio
   - scikit-learn
   - pyaudio (для работы с микрофонами)

## Запуск системы

### Автоматический запуск с микрофонами

Для полного запуска системы с микрофонами используйте скрипт `mic_startup.bat`:

1. Откройте командную строку
2. Перейдите в директорию проекта: `cd путь_к_проекту/kasatka/microfon`
3. Запустите скрипт: `mic_startup.bat`
4. Следуйте инструкциям на экране:
   - Выберите индекс микрофона из списка
   - Выберите режим работы (реальные микрофоны или тестовые WAV-файлы)

Скрипт запустит:
1. Бэкенд (нейронную сеть) на порту 8765 (WebSocket)
2. Клиенты микрофонов (на портах 5000, 5001, 5002, 5003)
3. Фронтенд (веб-интерфейс) на порту 3000

### Автоматический запуск без микрофонов

Если вам нужно запустить только сервер и веб-интерфейс (без микрофонов):

```
cd путь_к_проекту/kasatka/microfon
startup.bat
```

### Ручной запуск компонентов

Если вам нужно запустить компоненты вручную:

#### Запуск бэкенда (нейронной сети)

```
cd путь_к_проекту/kasatka/microfon
python RasbaryPi2.py
```

#### Запуск клиентов микрофонов

Посмотреть доступные аудиоустройства:
```
python mic_sender.py --list
```

Запустить клиент для микрофона 1:
```
python mic_sender.py --mic 1 --device 0
```

Для тестирования с WAV-файлом:
```
python mic_sender.py --mic 1 --test путь/к/файлу.wav
```

#### Запуск фронтенда

```
cd путь_к_проекту/kasatka/microfon/locator_static
npm install  # только при первом запуске
npm start
```

## Тестирование с WAV-файлами

Если у вас нет 4 микрофонов, вы можете использовать WAV-файлы для тестирования:

1. Создайте директорию `test` в папке проекта
2. Поместите туда WAV-файлы с названиями:
   - `mic1.wav`
   - `mic2.wav`
   - `mic3.wav`
   - `mic4.wav`
3. Запустите `mic_startup.bat` и выберите опцию использования тестовых файлов

## Принцип работы

1. Клиенты микрофонов захватывают аудиоданные и отправляют на сервер
2. Нейросеть анализирует звуковые данные и определяет наличие дрона в том или ином секторе
3. Информация о секторе передается по WebSocket на фронтенд
4. Фронтенд визуализирует активный сектор обнаружения

## Устранение неполадок

1. Если фронтенд не получает данные от бэкенда:
   - Убедитесь, что WebSocket сервер запущен и работает на порту 8765
   - Проверьте подключение к сети
   - Перезапустите все компоненты системы

2. Если нейронная сеть не запускается:
   - Убедитесь, что все необходимые библиотеки Python установлены
   - Проверьте наличие файла модели `sound_classifier_model.pth`

3. Если возникают проблемы с микрофонами:
   - Проверьте, что PyAudio установлен (`pip install pyaudio`)
   - На Windows может потребоваться установить Microsoft Visual C++ Build Tools
   - Попробуйте использовать другой индекс микрофона
   - Используйте режим тестирования с WAV-файлами 